{"remainingRequest":"/Users/kyy/Documents/ooad/酒店/hotel/front/node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js??vue-loader-options!/Users/kyy/Documents/ooad/酒店/hotel/front/src/views/reservation-custom.vue?vue&type=style&index=0&id=9db081a8&scoped=scoped&lang=css&","dependencies":[{"path":"/Users/kyy/Documents/ooad/酒店/hotel/front/src/views/reservation-custom.vue","mtime":1669694948451},{"path":"/Users/kyy/Documents/ooad/酒店/hotel/front/node_modules/_css-loader@1.0.1@css-loader/index.js","mtime":499162500000},{"path":"/Users/kyy/Documents/ooad/酒店/hotel/front/node_modules/_vue-loader@15.10.1@vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/kyy/Documents/ooad/酒店/hotel/front/node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/kyy/Documents/ooad/酒店/hotel/front/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kyy/Documents/ooad/酒店/hotel/front/node_modules/_vue-loader@15.10.1@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n.res-bg {\n  background: url(../assets/img/reservation.jpg);\n  background-size: cover;\n  height: 30vh;\n  border: 0px solid transparent;\n  border-bottom-left-radius: 10px;\n  border-bottom-right-radius: 10px;\n}\n\n.text {\n  font-size: 14px;\n}\n\n.item {\n  padding: 9px 0;\n}\n\n.res-form {\n  margin: -5rem 1rem 1rem 1rem;\n}\n\n/* .el-card__body {\n    padding: 20px 20px 20px 0px;\n  } */\n\n.el-select {\n  width: 100%;\n}\n\n.room-price {\n  font-size: 1.3rem;\n  color: #f56c6c;\n}\n",{"version":3,"sources":["reservation-custom.vue"],"names":[],"mappings":";AAgVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"reservation-custom.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <el-container class=\"wrapper\">\n      <el-main class=\"section text-left\">\n        <div class=\"res-bg\"></div>\n        <el-card class=\"box-card res-form\">\n          <div slot=\"header\" class=\"clearfix\">\n            <span>预订客房</span>\n          </div>\n          <div class=\"text item\">\n            <!-- <el-form\n              :model=\"resinfo\"\n              :rules=\"rules\"\n              ref=\"ruleForm\"\n              label-width=\"80px\"\n              class=\"demo-ruleForm\"\n            > -->\n\t\t\t<el-form\n              label-width=\"80px\"\n             \n            >\n              <el-form-item\n                label=\"客房类型\"\n                prop=\"type\"\n                @click=\"resolveData\"\n              >\n                <!-- <el-select v-model=\"resinfo.type\" placeholder=\"请选择\" :disabled=\"lockCondition\">\n\t\t\t\t\t\t\t\t\t<el-option v-for=\"item in roomtype\" :key=\"item.id\" :label=\"item.typeName\" :value=\"item.id\">\n\t\t\t\t\t\t\t\t\t</el-option>\n\t\t\t\t\t\t\t\t</el-select> -->\n                <el-form-item\n                  :label=\"$store.state.order.roomType\"\n                ></el-form-item>\n              </el-form-item>\n\n              <!-- <el-form-item label=\"入住时间\" required>\n\t\t\t\t\t\t\t\t<el-col :span=\"24\" class=\"mb-1\">\n\t\t\t\t\t\t\t\t\t<el-form-item prop=\"indate\"> -->\n              <!-- <el-date-picker :disabled=\"lockCondition\" type=\"datetime\" placeholder=\"入住日期\" v-model=\"resinfo.indate\" style=\"width: 100%;\">\n\t\t\t\t\t\t\t\t\t\t</el-date-picker> -->\n              <!-- <el-form-item :label=$store.state.order.start></el-form-item>\n\t\t\t\t\t\t\t\t\t</el-form-item>\n\t\t\t\t\t\t\t\t</el-col> -->\n              <!-- <el-col class=\"line text-center\" :span=\"24\">至</el-col> -->\n              <!-- <el-col :span=\"24\">\n\t\t\t\t\t\t\t\t\t<el-form-item prop=\"leavedate\"> -->\n              <!-- <el-date-picker :disabled=\"lockCondition\" type=\"datetime\" placeholder=\"离店日期\" v-model=\"resinfo.leavedate\" style=\"width: 100%;\">\n\t\t\t\t\t\t\t\t\t\t</el-date-picker> -->\n              <!-- <el-form-item :label=$store.state.order.start></el-form-item>\n\t\t\t\t\t\t\t\t\t</el-form-item>\n\t\t\t\t\t\t\t\t</el-col>\n\t\t\t\t\t\t\t</el-form-item> -->\n\n              <el-form-item\n                label=\"入住日期\"\n                prop=\"type\"\n                @click=\"resolveData\"\n              >\n                <!-- <el-select v-model=\"resinfo.type\" placeholder=\"请选择\" :disabled=\"lockCondition\">\n\t\t\t\t\t\t\t\t\t<el-option v-for=\"item in roomtype\" :key=\"item.id\" :label=\"item.typeName\" :value=\"item.id\">\n\t\t\t\t\t\t\t\t\t</el-option>\n\t\t\t\t\t\t\t\t</el-select> -->\n                <el-form-item :label=\"$store.state.order.start\" label-width=\"auto\"></el-form-item>\n              </el-form-item>\n\n              <el-form-item\n                label=\"离店日期\"\n                prop=\"type\"\n                @click=\"resolveData\"\n              >\n                <!-- <el-select v-model=\"resinfo.type\" placeholder=\"请选择\" :disabled=\"lockCondition\">\n\t\t\t\t\t\t\t\t\t<el-option v-for=\"item in roomtype\" :key=\"item.id\" :label=\"item.typeName\" :value=\"item.id\">\n\t\t\t\t\t\t\t\t\t</el-option>\n\t\t\t\t\t\t\t\t</el-select> -->\n                <el-form-item :label=\"$store.state.order.end\" label-width=\"auto\"></el-form-item>\n              </el-form-item>\n\n              <el-form-item>\n                <el-button\n                  :type=\"searchBtnType\"\n                  @click=\"checkroom\"\n                  :disabled=\"checkBtnDis\"\n                >\n                  <i :class=\"searchicon\"></i>\n                  查询可用房间\n                </el-button>\n              </el-form-item>\n\n              <!-- 提供一个房间号码对房间id的映射，即用户选择的是房间号，但存的是房间id -->\n              <el-form-item label=\"房间号码\" prop=\"id\" required>\n                <el-select\n                  v-model=\"resinfo.id\"\n                  placeholder=\"请先选择房间类型\"\n                  :disabled=\"isNotSelect\"\n                >\n                  <el-option\n                    v-for=\"item in roomnumber\"\n                    :key=\"item.id\"\n                    :label=\"item.number\"\n                    :value=\"item.id\"\n                  >\n                  </el-option>\n                </el-select>\n              </el-form-item>\n\n              <el-form-item label=\"住店人数\" prop=\"num\" required>\n                <el-input-number\n                  v-model=\"resinfo.num\"\n                  :min=\"1\"\n                  :max=\"maxp\"\n                  label=\"请输入\"\n                  :disabled=\"isNotSelect\"\n                ></el-input-number>\n                <span class=\"ml-1\">人</span>\n              </el-form-item>\n              <el-form-item label=\"提供发票\" prop=\"invoice\">\n                <el-switch\n                  v-model=\"resinfo.isNeedInvoice\"\n                  :disabled=\"isNotSelect\"\n                ></el-switch>\n              </el-form-item>\n              <el-form-item label=\"价格\">\n                <!-- <span v-model=\"resinfo.type\" class=\"room-price\">{{sumprice}} 元</span> -->\n              </el-form-item>\n              <el-form-item>\n                <el-button\n                  type=\"primary\"\n                  @click=\"submitForm('ruleForm')\"\n                  :disabled=\"isNotSelect\"\n                  >立即预订</el-button\n                >\n                <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\n              </el-form-item>\n            </el-form>\n          </div>\n        </el-card>\n        <!--        <el-button type=\"success\" @click=\"oktest\">预订成功测试</el-button>\n        <el-button type=\"danger\" @click=\"failtest\">预订失败测试</el-button> -->\n      </el-main>\n      <el-footer class=\"footer\">\n        <footbar></footbar>\n      </el-footer>\n\n      <el-dialog title=\"提示\" :visible.sync=\"dialogVisible\" width=\"95%\">\n        <span>你确定要提交预订单吗？</span>\n        <span slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"dialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"confirmSubmitForm\">确定</el-button>\n        </span>\n      </el-dialog>\n    </el-container>\n  </div>\n</template>\n\n<script>\nimport footbar from \"@/components/footbar.vue\";\nimport store from \"./../store\";\nexport default {\n  data() {\n    return {\n      resinfo: {\n        id: \"\",\n        type: \"\",\n        indate: \"\",\n        leavedate: \"\",\n        num: \"\",\n        isNeedInvoice: false,\n      },\n      price: 0,\n      sumprice: 0,\n      maxp: 1,\n      lockCondition: false,\n      isNotSelect: true,\n      checkBtnDis: false,\n      searchicon: \"el-icon-search\",\n      searchBtnType: \"primary\",\n      dialogVisible: false,\n      roomnumber: [],\n      roomtype: [],\n      rules: {\n        type: [\n          {\n            required: true,\n            message: \"请选择房间类型\",\n            trigger: \"change\",\n          },\n        ],\n        id: [\n          {\n            required: true,\n            message: \"请选择房间号\",\n            trigger: \"change\",\n          },\n        ],\n        indate: [\n          {\n            type: \"date\",\n            required: true,\n            message: \"请选择入住时间\",\n            trigger: \"change\",\n          },\n        ],\n        leavedate: [\n          {\n            type: \"date\",\n            required: true,\n            message: \"请选择离店时间\",\n            trigger: \"change\",\n          },\n        ],\n      },\n    };\n  },\n  components: {\n    footbar,\n  },\n  methods: {\n    submitForm(formName) {\n      this.dialogVisible = true;\n    },\n    resetForm(formName) {\n      this.checkBtnDis = false;\n      this.searchicon = \"el-icon-search\";\n      this.searchBtnType = \"primary\";\n      this.isNotSelect = true;\n      this.price = 0;\n      this.sumprice = 0;\n      this.resinfo.isNeedInvoice = false;\n      this.$refs[formName].resetFields();\n    },\n    oktest() {\n      this.$router.push(\"/submitok\");\n    },\n    failtest() {\n      this.$router.push(\"/submitfail\");\n    },\n    confirmSubmitForm() {\n      this.dialogVisible = false;\n      let json = {\n        roomId: parseInt(this.resinfo.id),\n        inTime: this.changeTimeStr(this.resinfo.indate),\n        leaveTime: this.changeTimeStr(this.resinfo.leavedate),\n        realPeople: this.resinfo.num,\n        fapiao: this.fapiao,\n      };\n      console.log(json);\n      this.axios\n        .post(\"http://localhost:8090/user/bookRoom\", json)\n        .then((res) => {\n          this.$router.push(\"/submitok\");\n        })\n        .catch((res) => {\n          this.$router.push(\"/submitfail\");\n        });\n    },\n    resolveData() {\n      // console.log(123123);\n      this.axios\n        .get(\"http://localhost:8090/user/listTypes\")\n        .then((res) => {\n          this.roomtype = res.data.data;\n          // console.log(this.roomtype);\n        })\n        .catch(() => {\n          console.log(\"死了\");\n        });\n    },\n    checkroom() {\n      this.checkBtnDis = true;\n      this.searchicon = \"el-icon-loading\";\n      this.axios\n        .post(\"http://localhost:8090/user/listRoomsByTypeId\", {\n          typeId: this.resinfo.type,\n          inTime: this.changeTimeStr(this.resinfo.indate),\n          leaveTime: this.changeTimeStr(this.resinfo.leavedate),\n        })\n        .then((res) => {\n          this.roomnumber = res.data.data;\n          console.log(this.roomnumber);\n          this.searchicon = \"el-icon-check\";\n          this.searchBtnType = \"success\";\n          this.isNotSelect = false;\n          this.lockCondition = true;\n          this.price = this.roomnumber[0].type.price;\n          this.maxp = this.roomnumber[0].maxPeople;\n          this.calcPrice();\n        })\n        .catch(() => {\n          this.searchicon = \"el-icon-close\";\n          this.searchBtnType = \"danger\";\n          console.log(\"error\");\n        });\n    },\n    changeTimeStr(str) {\n      str = str.toString();\n      str = str.replace(/ GMT.+$/, \"\"); // Or str = str.substring(0, 24)\n      let d = new Date(str);\n      let a = [\n        d.getFullYear(),\n        d.getMonth() + 1,\n        d.getDate(),\n        d.getHours(),\n        d.getMinutes(),\n        d.getSeconds(),\n      ];\n      for (var i = 0, len = a.length; i < len; i++) {\n        if (a[i] < 10) {\n          a[i] = \"0\" + a[i];\n        }\n      }\n      str = a[0] + \"-\" + a[1] + \"-\" + a[2] + \" \" + a[3] + \":\" + a[4];\n      return str;\n    },\n    calcPrice() {\n      let realday =\n        Math.abs(this.resinfo.leavedate - this.resinfo.indate) / 86400000;\n      console.log(Math.ceil(realday));\n      realday = Math.ceil(realday);\n      let price = this.price;\n      this.sumprice = price * realday;\n      console.log(this.sumprice, price, realday);\n    },\n  },\n  mounted() {\n    this.resolveData();\n  },\n  computed: {\n    fapiao() {\n      if (this.resinfo.isNeedInvoice == true) return 1;\n      else return 0;\n    },\n  },\n};\n</script>\n\n<style scoped=\"scoped\">\n.res-bg {\n  background: url(../assets/img/reservation.jpg);\n  background-size: cover;\n  height: 30vh;\n  border: 0px solid transparent;\n  border-bottom-left-radius: 10px;\n  border-bottom-right-radius: 10px;\n}\n\n.text {\n  font-size: 14px;\n}\n\n.item {\n  padding: 9px 0;\n}\n\n.res-form {\n  margin: -5rem 1rem 1rem 1rem;\n}\n\n/* .el-card__body {\n    padding: 20px 20px 20px 0px;\n  } */\n\n.el-select {\n  width: 100%;\n}\n\n.room-price {\n  font-size: 1.3rem;\n  color: #f56c6c;\n}\n</style>\n"]}]}